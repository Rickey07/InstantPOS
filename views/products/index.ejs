<%- include('../partials/header.ejs'); %>

<div class="container-fluid">
    <div class="container">
        <div class="container mt-3">
            <div class="row align-items-start">
              <div class="col">
              <span><i class="fas fa-book 5x"></i></span> List Products
              </div>
              <div class="col">
              <form action="/products" method="GET">  
                <div class="input-group mb-3">
                    <input type="text" class="form-control" aria-label="Amount (to the nearest dollar)" placeholder="Search Product By Name" name="name">
                   <button type="submit"><span class="input-group-text"><i class="fas fa-search"></i></span></button> 
                </div>
              </form>
              </div>
              <div class="col">
               <a href="/products/create" class="btn btn-primary float-right">Add Product</a>
              </div>
            </div>
            
    </div>
    <% if(locals.productErr) { %>
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong>Warning</strong> <%= productErr %>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
   <% } %>
    
    <table class="table">
        <thead>
          <tr class="table-dark">
            <th scope="col">#</th>
            <th scope="col">Product Name</th>
            <th scope="col">Weight</th>
            <th scope="col">Cost Price</th>
            <th scope="col">Sell Price</th>
            <th scope="col">Product Code</th>
            <th scope="col">Action</th>   
          </tr>
        </thead>
        <tbody>
          <% if(locals.products) { %>
            <% products.forEach((product , index) => { %>
              <tr>
                <th scope="row"><%= index + 1 %></th>
                <td><%= product.name %></td>
                <td><%= product.weight %>KG</td>
                <td><%= product.costPrice %></td>
                <td><%= product.salePrice %></td>
                <td><%= product.productCode %></td>
                <td>
                  <div class="d-flex">
                  <a href="/products/<%= product.id %>/edit" class="btn btn-success"><i class="fas fa-pen"></i></a> <form action="/products/<%= product.id %>?_method=DELETE" method="POST">
                  <button class="btn btn-danger" type="submit"><i class="fas fa-trash"></i></button>
                </form>
                </div></td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
</div>